<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><title>ePub 电子书排版最佳实践 - Andor Chen</title><meta name="description" content="安道的个人网站"/><meta name="author" content="安道"/><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.2.0/css/bootstrap.min.css"/><link rel="stylesheet" href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css"/><link rel="stylesheet" href="/assets/style.css"/></head><body><div class="wrapper"><div class="inner"> <header class="site-header clearfix"><div class="avatar"> <a href="/" title="首页"><img src="/assets/images/andor@2x.jpg" width="180" height="180" alt="" title=""/></a></div><h1 class="logo"><a href="/about/" title="关于安道">安道</a></h1> </header><div class="breadcrumbs"> <a href="/" title="首页">首页</a> // <a href="/archive/" title="文章归档">文章归档</a> // ePub 电子书排版最佳实践</div><article class="hentry entry post"> <header class="entry-header"><h1 class="entry-title">ePub 电子书排版最佳实践</h1><p class="entry-meta">发布于2015年9月13日</p> </header><div class="entry-content"><p>在制作《<a href="http://railstutorial-china.org" title="Ruby on Rails 教程">Ruby on Rails 教程</a>》和《<a href="http://jekyll-china.com/book/" title="Jekyll 小书">Jekyll 小书</a>》电子书的过程中，积累了一些经验，班门弄斧，姑且称之为“最佳实践”吧。</p><h2>没有“页”这个概念</h2><p>这是大前提，制作 ePub 电子书时一定要谨记这一点。ePub 电子书是“流式”的，不像实体书和 PDF 电子书那样有“页”这个概念。因此，很多效果或功能在 ePub 电子书中实现不了，比如说页眉和页码等（ePub 阅读器通常会在屏幕上部实现“页眉”，显示当前查看的书名和章节名；而且也会“分页”，但对阅读器来说，这个页与实体书的页并不一样）。</p><p>因为没有页码，书中的交叉引用不能简单地使用“参见 XX 页”，而要链接到章节名或章节序号。</p><h2>ePub 文件是小型的静态网站</h2><p>这也是一个核心概念。你可以把 ePub 电子书的扩展名改为 <code class="highlighter-rouge">.zip</code>，然后解压。你会看到解压得到的基本上就是个简单的静态网站：有 XHTML 文件，有图像，有样式表。如下所示：</p><div class="highlighter-rouge"><pre class="highlight"><code>├── META-INF/
├── OEBPS
│   ├── chapter1.xhtml
│   ├── chapter2.xhtml
│   ├── chapter3.xhtml
│   ├── cover.jpg
│   ├── epub.css
│   ├── images/
│   ├── package.opf
│   └── toc.ncx
└── mimetype
</code></pre></div><p>当然，这个网站与我们平常所说的网站有所不同，这是由 Web 浏览器与 ePub 阅读器之间的功能差异造成的。例如，在 ePub 电子书中基本不能使用 JavaScript，对 SVG 的支持有限，只能使用部分 CSS 属性。不过，ePub 电子书可以嵌入字体。</p><h2>交叉引用</h2><p>交叉引用是指引用书内的某个部分，比如“参见 1.2.3 节”，“如图 2.7”，等等。交叉引用最好加上链接，因为电子书不像实体书那样可以来回翻阅，加入链接便于读者定位所引用的内容。</p><h2>提供目录</h2><p>ePub 阅读器一般都会使用特殊的交互方式显示目录，但不会自己去解析内容，再生成目录。所以我们要在 ePub 文件中加入目录，让阅读器读取。如果内容较多，想显示次级目录，比如“3.2 节”，一定要设定目录的层级，不要把所有目录都放在相同的层级。指定目录层级的方式是，在 <code class="highlighter-rouge">navPoint</code> 元素中嵌套 <code class="highlighter-rouge">navPoint</code> 元素，如下所示：</p><div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;navMap&gt;</span>
    <span class="nt">&lt;navPoint</span> <span class="na">id=</span><span class="s">"ch1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;navLabel&gt;</span>
            <span class="nt">&lt;text&gt;</span>第 1 章<span class="nt">&lt;/text&gt;</span>
        <span class="nt">&lt;/navLabel&gt;</span>
        <span class="nt">&lt;content</span> <span class="na">src=</span><span class="s">"ch1.html#ch_1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;navPoint</span> <span class="na">class=</span><span class="s">"h2"</span> <span class="na">id=</span><span class="s">"ch_1_1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;navLabel&gt;</span>
                <span class="nt">&lt;text&gt;</span>1.1 节<span class="nt">&lt;/text&gt;</span>
            <span class="nt">&lt;/navLabel&gt;</span>
            <span class="nt">&lt;content</span> <span class="na">src=</span><span class="s">"ch1.html#ch_1_1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/navPoint&gt;</span>
    <span class="nt">&lt;/navPoint&gt;</span>
    <span class="nt">&lt;navPoint</span> <span class="na">id=</span><span class="s">"ch2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;navLabel&gt;</span>
            <span class="nt">&lt;text&gt;</span>第 2 章<span class="nt">&lt;/text&gt;</span>
        <span class="nt">&lt;/navLabel&gt;</span>
        <span class="nt">&lt;content</span> <span class="na">src=</span><span class="s">"ch2.html#ch_2"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/navPoint&gt;</span>
<span class="nt">&lt;/navMap&gt;</span>
</code></pre></div><h2>不要把整本书都放在一个 XHTML 文件里</h2><p>一本书的内容有长有短，但是，不管多长，建议一章放在一个 XHTML 文件里，不要把整本书都放在一个 XHTML 文件里。如果都放在一个文件里，ePub 阅读器解析的速度会变慢。</p><h2>重置默认样式</h2><p>ePub 阅读器就像 Web 浏览器一样，会内置默认的样式。为了更好的掌控，实现较为统一的视觉效果，建议在样式表开头重置样式。比如说：</p><div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">html</span><span class="o">,</span> <span class="nt">body</span><span class="o">,</span> <span class="nt">div</span><span class="o">,</span> <span class="nt">span</span><span class="o">,</span> <span class="nt">applet</span><span class="o">,</span> <span class="nt">object</span><span class="o">,</span> <span class="nt">iframe</span><span class="o">,</span>
<span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span><span class="o">,</span> <span class="nt">p</span><span class="o">,</span> <span class="nt">blockquote</span><span class="o">,</span> <span class="nt">pre</span><span class="o">,</span> <span class="nt">a</span><span class="o">,</span>
<span class="nt">abbr</span><span class="o">,</span> <span class="nt">acronym</span><span class="o">,</span> <span class="nt">address</span><span class="o">,</span> <span class="nt">big</span><span class="o">,</span> <span class="nt">cite</span><span class="o">,</span> <span class="nt">code</span><span class="o">,</span> <span class="nt">del</span><span class="o">,</span>
<span class="nt">dfn</span><span class="o">,</span> <span class="nt">em</span><span class="o">,</span> <span class="nt">font</span><span class="o">,</span> <span class="nt">img</span><span class="o">,</span> <span class="nt">ins</span><span class="o">,</span> <span class="nt">kbd</span><span class="o">,</span> <span class="nt">q</span><span class="o">,</span> <span class="nt">s</span><span class="o">,</span> <span class="nt">samp</span><span class="o">,</span> <span class="nt">small</span><span class="o">,</span>
<span class="nt">strike</span><span class="o">,</span> <span class="nt">strong</span><span class="o">,</span> <span class="nt">sub</span><span class="o">,</span> <span class="nt">sup</span><span class="o">,</span> <span class="nt">tt</span><span class="o">,</span> <span class="nt">var</span><span class="o">,</span> <span class="nt">b</span><span class="o">,</span> <span class="nt">u</span><span class="o">,</span> <span class="nt">i</span><span class="o">,</span> <span class="nt">center</span><span class="o">,</span>
<span class="nt">dl</span><span class="o">,</span> <span class="nt">dt</span><span class="o">,</span> <span class="nt">dd</span><span class="o">,</span> <span class="nt">ol</span><span class="o">,</span> <span class="nt">ul</span><span class="o">,</span> <span class="nt">li</span><span class="o">,</span> <span class="nt">fieldset</span><span class="o">,</span> <span class="nt">form</span><span class="o">,</span> <span class="nt">label</span><span class="o">,</span> <span class="nt">legend</span><span class="o">,</span>
<span class="nt">table</span><span class="o">,</span> <span class="nt">caption</span><span class="o">,</span> <span class="nt">tbody</span><span class="o">,</span> <span class="nt">tfoot</span><span class="o">,</span> <span class="nt">thead</span><span class="o">,</span> <span class="nt">tr</span><span class="o">,</span> <span class="nt">th</span><span class="o">,</span> <span class="nt">td</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">outline</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">vertical-align</span><span class="p">:</span> <span class="nb">baseline</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2>按章“换页”</h2><p>ePub 电子书虽然没有“页”这个概念，却可以换页（严格来说应该是“换屏”）。从视觉上来看，换页就是新起一屏显示内容，让相对独立的内容（例如两章）不连在一起。一般来说，建议每章结束后换页，使用下述 CSS 代码实现：</p><div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">div</span><span class="nc">.chapter</span> <span class="p">{</span>
    <span class="nl">page-break-after</span><span class="p">:</span> <span class="nb">always</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2>字体</h2><p>ePub 阅读器底层的操作系统（例如 iOS，Android 和各种定制的 ROM）往往会提供不同的字体，因此不能期望读者的系统中一定有某个字体。设置字体时要指定通用字体族（<code class="highlighter-rouge">serif</code>，<code class="highlighter-rouge">sans-serif</code> 或 <code class="highlighter-rouge">monospace</code>），让阅读器或底层系统判断要使用哪个字体。当然，我们也可以指定各种系统中常用的字体，提供更好的阅读体验。</p><p>如果十分想保持一致的阅读体验，还可以使用 <code class="highlighter-rouge">@font-face</code> 嵌入字体。但是要考虑嵌入的字体会不会让电子书的体积变得特别大，影响传输速度。</p><p>如果指定了字体，而不是让阅读器自行判断该使用哪个字体，在 iBooks 中会遇到一个问题：没使用指定的字体。这个问题的解决方法是，在 <code class="highlighter-rouge">.opf</code> 文件中加入下述元素：</p><div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"ibooks:specified-fonts"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/meta&gt;</span>
</code></pre></div><p>添加这个属性后，你会发现，在 iBooks 的外观设置中，字体项目下多了一个“Original”。这个选项的意思是，使用电子书中指定的字体。</p><figure> <img src="/assets/images/figures/ibooks-fonts.png" alt="让 iBooks 使用指定的字体"/> <figcaption>让 iBooks 使用指定的字体</figcaption> </figure><h2>字号</h2><p>我想你一定有这样的经历——调整电子书的文字大小。这种情况经常出现，因此，不要使用固定字号，例如 <code class="highlighter-rouge">12px</code>，而要使用便于缩放的字号单位。ePub 电子书的字号一般建议使用百分比为单位，比如 <code class="highlighter-rouge">80%</code>。</p><h2>为标题加序号</h2><p>书中的各级标题往往使用不同于正文的字体和字号显示，但是在手持设备中，字号之间的差异并不明显。为了让读者对一本书的纲要有全局的认识，建议在标题前加上序号，例如：“1.2 二级标题”，“1.2.3 三级标题”。</p><h2>考虑兼容性</h2><p>是的，与浏览器一样，我们也要考虑 ePub 阅读器的兼容性。就我目前的观察，iBooks 对标准的支持是最好的。但我们不能期望所有读者都使用 iOS/OS X 系统。下面举个例子。</p><p>我平常看书喜欢用多看（手机和平板），但是<a href="/2014/06/duokan-xhtml-entities.html" title="多看对 XHTML 实体的支持并不好">多看对 XHTML 实体的支持并不好</a>，有些特殊的符号显示不出来。这时就要专门针对多看编写样式：</p><div class="highlighter-rouge"><pre class="highlight"><code><span class="nc">.symbol</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="s2">'DK-SYMBOL'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p><code class="highlighter-rouge">DK-SYMBOL</code> 是多看自带的字体，用于显示一些特殊的字体。</p><h2>其他</h2><p>除了上面列出的几点之外，还有一些推荐的做法，在此不一一展开详述。</p><ul><li>不要定义大块背景色；</li><li>脚注加上返回链接；</li><li>尽量不使用某个阅读器专属的功能；</li></ul></div><ul class="entry-tags"><li><a class="btn btn-default btn-sm" href="/tags/#ebook-ref" title="电子书">电子书</a></li></ul> </article><ul class="pager"><li class="previous"> <a rel="prev" href="/2015/08/stem.html" title="在电子书中渲染公式">« 上一篇文章</a></li></ul><footer class="site-footer clearfix"><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"><ul class="socials"><li><a href="/feed.xml" title="订阅网站更新"><i class="fa fa-rss"></i></a></li><li><a href="mailto:andor.chen.27@gmail.com" title="电子邮件"><i class="fa fa-envelope-o"></i></a></li><li><a href="https://twitter.com/Andor_Chen" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="http://www.weibo.com/andor27/" title="微博" target="_blank"><i class="fa fa-weibo"></i></a></li><li><a href="https://github.com/AndorChen" title="GitHub" target="_blank"><i class="fa fa-github"></i></a></li><li><a class="douban" href="http://www.douban.com/people/Andor/" title="豆瓣" target="_blank">豆</a></li></ul><p class="copyright">© 1988- 2015。如无特殊说明，本站内容基于“<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" title="CC BY-NC-SA 3.0" target="_blank">CC BY-NC-SA 3.0</a>”发布。</p><p class="powered-by"><a href="http://jekyllrb.com" title="本站使用 Jekyll 生成" target="_blank"><img src="/assets/images/jekyll-logo@2x.png" width="60" height="24" alt="Jekyll Logo" title="本站使用 Jekyll 生成"/></a></p></div> </footer></div></div><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-69344223-1","auto"),ga("send","pageview")</script></body></html>